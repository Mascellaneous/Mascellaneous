<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>動態肌肉解剖圖解</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --highlight: #e74c3c;
            --bg: #f0f2f5;
            --skin: #ecf0f1;
            --skin-stroke: #95a5a6;
        }

        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background: var(--bg);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            background: var(--primary);
            color: white;
            width: 100%;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .main-layout {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            width: 100%;
        }

        /* Controls Panel */
        .controls-panel {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .nav-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .nav-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: none;
            font-size: 1.1rem;
            cursor: pointer;
            color: #7f8c8d;
            font-weight: bold;
        }

        .nav-btn.active {
            color: var(--accent);
            border-bottom: 3px solid var(--accent);
        }

        .btn-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .ex-btn {
            padding: 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            font-size: 1rem;
            color: var(--primary);
        }

        .ex-btn:hover {
            background: #f8f9fa;
            border-color: var(--accent);
        }

        .ex-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }

        .description-box {
            margin-top: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--accent);
        }

        /* Visualization Panel */
        .visual-panel {
            flex: 1;
            min-width: 300px;
            height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        svg {
            height: 90%;
            width: auto;
            overflow: visible;
        }

        /* SVG Parts Styling */
        .limb-part {
            fill: var(--skin);
            stroke: var(--skin-stroke);
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .muscle {
            fill: #bdc3c7;
            opacity: 0.4;
            transition: fill 0.3s;
        }

        .muscle.highlight {
            fill: var(--highlight);
            opacity: 0.9;
            filter: drop-shadow(0 0 3px rgba(231, 76, 60, 0.5));
        }

        /* --- ANIMATION DEFINITIONS --- */

        /* Pivot Points (Transform Origins) */
        #group-forearm { transform-origin: 150px 250px; } /* Elbow */
        #group-whole-arm { transform-origin: 150px 80px; } /* Shoulder */
        #group-hand { transform-origin: 150px 420px; } /* Wrist */
        
        #group-shin { transform-origin: 150px 280px; } /* Knee */
        #group-whole-leg { transform-origin: 150px 80px; } /* Hip */
        #group-foot { transform-origin: 160px 450px; } /* Ankle */

        /* 1. Bicep Curl Animation */
        .anim-bicep-curl #group-forearm {
            animation: curl-arm 2s ease-in-out infinite alternate;
        }
        .anim-bicep-curl #m-biceps {
            animation: bulge 2s ease-in-out infinite alternate;
        }
        @keyframes curl-arm {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-110deg); }
        }

        /* 2. Tricep Extension Animation */
        /* Start from bent, go to straight */
        .anim-tricep-ext #group-forearm {
            animation: extend-arm 2s ease-in-out infinite alternate;
        }
        .anim-tricep-ext #m-triceps {
            animation: bulge 2s ease-in-out infinite alternate;
        }
        @keyframes extend-arm {
            0% { transform: rotate(-110deg); }
            100% { transform: rotate(0deg); }
        }

        /* 3. Shoulder Press */
        .anim-shoulder-press #group-whole-arm {
            animation: press-arm 2s ease-in-out infinite alternate;
        }
        .anim-shoulder-press #group-forearm {
            animation: press-forearm-fix 2s ease-in-out infinite alternate;
        }
        @keyframes press-arm {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-140deg); }
        }
        @keyframes press-forearm-fix {
            /* Keep forearm relative to gravity slightly */
            0% { transform: rotate(-120deg); }
            100% { transform: rotate(0deg); }
        }

        /* 4. Wrist Curl */
        .anim-wrist-curl #group-hand {
            animation: curl-wrist 1.5s ease-in-out infinite alternate;
        }
        @keyframes curl-wrist {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-45deg); }
        }

        /* 5. Leg Extension (Kick) */
        .anim-leg-ext #group-shin {
            animation: kick-leg 2s ease-in-out infinite alternate;
        }
        @keyframes kick-leg {
            0% { transform: rotate(0deg); } /* Bent sitting position logic needed, but simplified here */
            100% { transform: rotate(-90deg); }
        }
        /* Adjustment for Leg Ext: Start with knee bent 90deg visually, then straighten */
        .anim-leg-ext #group-shin {
             /* Override default to start bent */
             transform: rotate(0deg); 
        }
        @keyframes kick-leg {
            0% { transform: rotate(0deg); } /* Vertical shin */
            100% { transform: rotate(-90deg); } /* Horizontal shin */
        }

        /* 6. Leg Curl (Hamstring) */
        .anim-leg-curl #group-shin {
            animation: curl-leg 2s ease-in-out infinite alternate;
        }
        @keyframes curl-leg {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(90deg); }
        }

        /* 7. Squat (Simulated) */
        /* Complex: Thigh moves up (hip flex), Shin moves to keep foot planted */
        .anim-squat #group-whole-leg {
            animation: squat-thigh 2.5s ease-in-out infinite alternate;
        }
        .anim-squat #group-shin {
            animation: squat-shin 2.5s ease-in-out infinite alternate;
        }
        .anim-squat #group-foot {
            animation: squat-foot 2.5s ease-in-out infinite alternate;
        }
        
        @keyframes squat-thigh {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-70deg) translate(-20px, -20px); }
        }
        @keyframes squat-shin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(140deg); }
        }
        @keyframes squat-foot {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-70deg); } /* Keep foot flat */
        }

        /* 8. Calf Raise */
        .anim-calf-raise #group-foot {
            animation: tip-toe 1.5s ease-in-out infinite alternate;
        }
        .anim-calf-raise {
            animation: body-lift 1.5s ease-in-out infinite alternate;
        }
        @keyframes tip-toe {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(35deg); }
        }
        @keyframes body-lift {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px); }
        }

        /* Muscle Bulge Generic Animation */
        @keyframes bulge {
            0% { transform: scale(1); }
            100% { transform: scale(1.15); } /* Subtle bulge */
        }

        /* Labels */
        .label-text {
            font-size: 14px;
            font-weight: bold;
            fill: var(--primary);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .label-line {
            stroke: var(--primary);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .visible { opacity: 1; }

    </style>
</head>
<body>

<header>
    <h1>動態肌肉解剖實驗室</h1>
    <p style="margin:5px 0 0; opacity:0.8; font-size:0.9rem;">觀察動作循環與肌肉收縮的關係</p>
</header>

<div class="main-layout">
    
    <!-- Controls -->
    <div class="controls-panel">
        <div class="nav-tabs">
            <button class="nav-btn active" onclick="setLimb('arm')">上肢 (手臂)</button>
            <button class="nav-btn" onclick="setLimb('leg')">下肢 (腿部)</button>
        </div>

        <!-- Arm Buttons -->
        <div id="btns-arm" class="btn-grid">
            <button class="ex-btn" onclick="playAnim('bicep_curl')">二頭肌彎舉</button>
            <button class="ex-btn" onclick="playAnim('tricep_ext')">三頭肌伸展</button>
            <button class="ex-btn" onclick="playAnim('shoulder_press')">肩推舉</button>
            <button class="ex-btn" onclick="playAnim('wrist_curl')">手腕屈曲</button>
        </div>

        <!-- Leg Buttons -->
        <div id="btns-leg" class="btn-grid" style="display:none;">
            <button class="ex-btn" onclick="playAnim('squat')">深蹲</button>
            <button class="ex-btn" onclick="playAnim('leg_ext')">踢腿機伸展</button>
            <button class="ex-btn" onclick="playAnim('leg_curl')">腿後勾</button>
            <button class="ex-btn" onclick="playAnim('calf_raise')">提踵 (踮腳)</button>
        </div>

        <div class="description-box">
            <h3 id="desc-title" style="margin-top:0; color:var(--primary)">準備開始</h3>
            <p id="desc-text" style="line-height:1.6; color:#555;">請點擊上方按鈕。模型將會自動重複動作，並標示出正在出力的肌肉。</p>
        </div>
    </div>

    <!-- Visuals -->
    <div class="visual-panel" id="visual-container">
        
        <!-- ARM SVG -->
        <svg id="svg-arm" viewBox="0 0 300 500">
            <defs>
                <filter id="glow">
                    <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
                    <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
                </filter>
            </defs>

            <!-- Group: Whole Arm (Pivots at Shoulder) -->
            <g id="group-whole-arm">
                <!-- Shoulder/Torso Fragment -->
                <path class="limb-part" d="M80,50 Q150,40 180,80 L180,120 L80,120 Z" fill="#ecf0f1" />

                <!-- Upper Arm Bone Area -->
                <path class="limb-part" d="M120,80 Q170,80 170,150 Q160,250 130,250 Q100,250 100,150 Q100,80 120,80" />

                <!-- Muscles: Upper Arm (Attached to Upper Arm Group) -->
                <path id="m-deltoid" class="muscle" d="M100,70 Q160,60 175,120 Q140,140 90,120" style="transform-origin: 130px 90px;" />
                <path id="m-biceps" class="muscle" d="M135,130 Q165,190 135,240 Q125,190 135,130" style="transform-origin: 145px 185px;" />
                <path id="m-triceps" class="muscle" d="M105,130 Q85,190 105,240 Q115,190 105,130" style="transform-origin: 95px 185px;" />

                <!-- Group: Forearm (Pivots at Elbow: 150, 250) -->
                <g id="group-forearm">
                    <path class="limb-part" d="M130,250 Q150,350 140,420 Q120,420 110,350 Q100,280 110,250" />
                    
                    <!-- Muscles: Forearm -->
                    <path id="m-forearm" class="muscle" d="M115,260 Q135,320 125,380 Q110,320 115,260" />

                    <!-- Group: Hand (Pivots at Wrist: 150, 420 approx) -->
                    <g id="group-hand">
                        <circle class="limb-part" cx="130" cy="435" r="18" />
                        <path class="limb-part" d="M120,445 L120,460 L140,460 L140,445" />
                    </g>
                </g>
            </g>

            <!-- Labels -->
            <g id="lbl-biceps" class="lbl-group">
                <line x1="160" y1="180" x2="220" y2="180" class="label-line" />
                <text x="225" y="185" class="label-text">二頭肌 (收縮)</text>
            </g>
            <g id="lbl-triceps" class="lbl-group">
                <line x1="90" y1="180" x2="30" y2="180" class="label-line" />
                <text x="25" y="185" class="label-text" text-anchor="end">三頭肌 (收縮)</text>
            </g>
            <g id="lbl-deltoid" class="lbl-group">
                <line x1="170" y1="90" x2="230" y2="90" class="label-line" />
                <text x="235" y="95" class="label-text">三角肌</text>
            </g>
        </svg>

        <!-- LEG SVG -->
        <svg id="svg-leg" viewBox="0 0 300 500" style="display:none;">
            <!-- Group: Whole Leg (Pivots at Hip) -->
            <g id="group-whole-leg">
                <!-- Hip/Torso -->
                <path class="limb-part" d="M60,50 Q140,40 180,80 L160,130 L80,130 Z" fill="#ecf0f1"/>

                <!-- Thigh -->
                <path class="limb-part" d="M90,130 Q180,130 180,280 Q140,300 100,280 Q90,200 90,130" />

                <!-- Muscles: Thigh -->
                <path id="m-glutes" class="muscle" d="M70,70 Q130,60 160,100 Q150,150 80,140 Z" />
                <path id="m-quads" class="muscle" d="M130,140 Q175,200 160,270 Q130,240 130,140" style="transform-origin: 150px 200px;" />
                <path id="m-hamstrings" class="muscle" d="M100,140 Q85,200 110,270 Q125,200 125,140" style="transform-origin: 105px 200px;" />

                <!-- Group: Shin (Pivots at Knee: 150, 280) -->
                <g id="group-shin">
                    <path class="limb-part" d="M110,280 Q160,350 150,450 Q110,450 100,350 Q100,300 110,280" />
                    
                    <!-- Muscles: Calf -->
                    <path id="m-calves" class="muscle" d="M105,290 Q90,350 110,410 Q130,350 130,290" style="transform-origin: 110px 350px;" />

                    <!-- Group: Foot (Pivots at Ankle: 160, 450 approx) -->
                    <g id="group-foot">
                        <path class="limb-part" d="M100,450 L160,450 L170,480 L100,480 Z" />
                    </g>
                </g>
            </g>

            <!-- Labels -->
            <g id="lbl-quads" class="lbl-group">
                <line x1="170" y1="200" x2="230" y2="200" class="label-line" />
                <text x="235" y="205" class="label-text">股四頭肌</text>
            </g>
            <g id="lbl-hamstrings" class="lbl-group">
                <line x1="95" y1="200" x2="35" y2="200" class="label-line" />
                <text x="30" y="205" class="label-text" text-anchor="end">腿後腱肌群</text>
            </g>
            <g id="lbl-calves" class="lbl-group">
                <line x1="100" y1="350" x2="40" y2="350" class="label-line" />
                <text x="35" y="355" class="label-text" text-anchor="end">小腿肌</text>
            </g>
        </svg>

    </div>
</div>

<script>
    const data = {
        bicep_curl: {
            title: "二頭肌彎舉 (Bicep Curl)",
            desc: "手臂反覆彎曲。這是單關節動作，前臂圍繞肘關節向上旋轉。主要訓練**肱二頭肌**。",
            animClass: "anim-bicep-curl",
            muscles: ["m-biceps"],
            labels: ["lbl-biceps"]
        },
        tricep_ext: {
            title: "三頭肌伸展 (Tricep Extension)",
            desc: "手臂由彎曲狀態用力伸直。這是對抗阻力伸展肘關節的動作，主要訓練手臂後側的**肱三頭肌**。",
            animClass: "anim-tricep-ext",
            muscles: ["m-triceps"],
            labels: ["lbl-triceps"]
        },
        shoulder_press: {
            title: "肩推舉 (Shoulder Press)",
            desc: "將手臂向上推舉過頭。這個複合動作涉及肩關節與肘關節，主要由**三角肌**發力，三頭肌輔助。",
            animClass: "anim-shoulder-press",
            muscles: ["m-deltoid"],
            labels: ["lbl-deltoid"]
        },
        wrist_curl: {
            title: "手腕屈曲 (Wrist Curl)",
            desc: "固定前臂，僅活動手腕。這能直接刺激**前臂屈肌群**，對於提升握力很有幫助。",
            animClass: "anim-wrist-curl",
            muscles: ["m-forearm"],
            labels: []
        },
        squat: {
            title: "深蹲 (Squat)",
            desc: "模擬坐下的動作。髖關節與膝關節同時彎曲。這是全身性的動作，強烈刺激**股四頭肌**與**臀大肌**。",
            animClass: "anim-squat",
            muscles: ["m-quads", "m-glutes"],
            labels: ["lbl-quads"]
        },
        leg_ext: {
            title: "踢腿機伸展 (Leg Extension)",
            desc: "坐姿將小腿踢直。這是膝關節的單一動作，能完全孤立並強化大腿前側的**股四頭肌**。",
            animClass: "anim-leg-ext",
            muscles: ["m-quads"],
            labels: ["lbl-quads"]
        },
        leg_curl: {
            title: "腿後勾 (Leg Curl)",
            desc: "將腳跟勾向臀部。這主要訓練大腿後側的**腿後腱肌群**，這部分肌肉常被忽略。",
            animClass: "anim-leg-curl",
            muscles: ["m-hamstrings"],
            labels: ["lbl-hamstrings"]
        },
        calf_raise: {
            title: "提踵 (Calf Raise)",
            desc: "踮起腳尖。透過踝關節的蹠屈動作，訓練小腿後側的**腓腸肌**。",
            animClass: "anim-calf-raise",
            muscles: ["m-calves"],
            labels: ["lbl-calves"]
        }
    };

    function setLimb(limb) {
        // UI Tabs
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        // Toggle Buttons
        document.getElementById('btns-arm').style.display = limb === 'arm' ? 'grid' : 'none';
        document.getElementById('btns-leg').style.display = limb === 'leg' ? 'grid' : 'none';

        // Toggle SVG
        document.getElementById('svg-arm').style.display = limb === 'arm' ? 'block' : 'none';
        document.getElementById('svg-leg').style.display = limb === 'leg' ? 'block' : 'none';

        resetAll();
    }

    function playAnim(key) {
        const info = data[key];
        const container = document.getElementById('visual-container');
        
        // 1. Reset previous states
        resetAll();

        // 2. Set Button Active
        document.querySelectorAll('.ex-btn').forEach(b => {
            b.classList.remove('active');
            if(b.getAttribute('onclick').includes(key)) b.classList.add('active');
        });

        // 3. Update Text
        document.getElementById('desc-title').innerText = info.title;
        document.getElementById('desc-text').innerHTML = info.desc.replace(/\*\*(.*?)\*\*/g, '<strong style="color:var(--highlight)">$1</strong>');

        // 4. Apply Animation Class to Container
        // This triggers the CSS @keyframes defined in style
        container.className = 'visual-panel ' + info.animClass;

        // 5. Highlight Muscles
        info.muscles.forEach(id => {
            const el = document.getElementById(id);
            if(el) el.classList.add('highlight');
        });

        // 6. Show Labels
        info.labels.forEach(id => {
            const el = document.getElementById(id);
            if(el) {
                el.querySelector('.label-line').style.opacity = 1;
                el.querySelector('.label-text').style.opacity = 1;
            }
        });
    }

    function resetAll() {
        // Clear animation classes
        document.getElementById('visual-container').className = 'visual-panel';
        
        // Clear muscle highlights
        document.querySelectorAll('.muscle').forEach(m => m.classList.remove('highlight'));
        
        // Clear labels
        document.querySelectorAll('.label-line, .label-text').forEach(l => l.style.opacity = 0);

        // Clear button active states
        document.querySelectorAll('.ex-btn').forEach(b => b.classList.remove('active'));
    }
</script>

</body>
</html>
